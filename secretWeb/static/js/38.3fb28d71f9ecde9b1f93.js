webpackJsonp([38],{VASk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),n=a("NYxO"),r={data:function(){return{chatList:[],textareaMsg:""}},computed:i()({},Object(n.b)(["userInfo"])),components:{vBreadcrumb:function(t){return a.e(51).then(function(){var e=[a("1JPr")];t.apply(null,e)}.bind(this)).catch(a.oe)}},mounted:function(){var t=this;this.$nextTick(function(){t.$refs.textareaFocus.focus(),t.getChatLog(),t.textareaEven()})},methods:{textareaEven:function(){this.$refs.textareaFocus.addEventListener("keydown",function(t){13===t.keyCode&&t.preventDefault()})},scrollBottom:function(){var t=this;this.$nextTick(function(){t.$refs.chatContent.scrollTop=t.$refs.chatContent.scrollHeight})},sendChatMsg:function(){var t=(new Date).getTime(),e={msg:this.textareaMsg,time:this.$changeDate(t,"/",1),id:this.chatList.length+1,isRobot:!1};""!==this.textareaMsg.trim()&&(this.chatList.push(e),this.scrollBottom(),this.getAiReply()),this.textareaMsg=""},getAiReply:function(){var t=this;this.textareaMsg=encodeURI(this.textareaMsg).trim(),this.$http.post(this.$api+"/message/getAiReplyMessage?text="+this.textareaMsg+"&toUserName="+this.userInfo.userName+"&productid="+this.$route.query.productId).then(function(e){if(e.data.success){var a=(new Date).getTime(),s={msg:e.data.data,time:t.$changeDate(a,"/",1),id:t.chatList.length+1,isRobot:!0};t.chatList.push(s),t.scrollBottom()}else"NOT_LOGGEDIN"===e.data.resultCode&&t.$router.push("/login")}).catch(function(t){console.log(t)})},getChatLog:function(){var t=this;this.$http.post(this.$api+"/message/userMessageLogList").then(function(e){if(e.data.success){for(var a=e.data.data.reverse(),s=0;s<e.data.data.length;s++){var i={msg:"",time:t.$changeDate(a[s].createtime,"/",1),id:0,isRobot:!1},n={msg:"",time:t.$changeDate(a[s].createtime,"/",1),id:0,isRobot:!0},r=JSON.parse(a[s].text).current,o=JSON.parse(JSON.parse(a[s].data)).text;i.msg=r,i.id=t.chatList.length+1,t.chatList.push(i),n.msg=o,n.id=t.chatList.length+1,t.chatList.push(n)}t.scrollBottom()}else"NOT_LOGGEDIN"===e.data.msg&&t.$router.push("/login")}).catch(function(t){console.log(t)})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"aiExperience"},[a("v-breadcrumb",{attrs:{breadcrumbList:t.$t("AI.aiExperience.breadcrumbList")}}),t._v(" "),a("div",{staticClass:"chatBox"},[a("div",{staticClass:"chatBox-head"},[t._v(t._s(t.$t("AI.aiExperience.text1")))]),t._v(" "),a("ul",{ref:"chatContent",staticClass:"chatBox-content",attrs:{id:"chatContent"}},t._l(t.chatList,function(e){return a("li",{key:e.id,class:{chatRightLi:!e.isRobot}},[e.isRobot?t._e():a("img",{attrs:{src:t.userInfo.imgUrl,alt:""}}),t._v(" "),e.isRobot?a("img",{attrs:{src:t.$route.query.aiImg,alt:""}}):t._e(),t._v(" "),a("div",[a("p",[t._v(t._s(e.msg))])])])}),0),t._v(" "),a("div",{staticClass:"chatBox-input",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendChatMsg()}}},[a("div",{staticClass:"chatBox-input-box"},[a("div",{staticClass:"textareaBox"},[a("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.textareaMsg,expression:"textareaMsg",modifiers:{trim:!0}}],ref:"textareaFocus",attrs:{placeholder:t.$t("AI.aiExperience.text2")},domProps:{value:t.textareaMsg},on:{input:function(e){e.target.composing||(t.textareaMsg=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),a("div",{staticClass:"btn-box"},[a("button",{staticClass:"secret-btn",on:{click:function(e){return t.sendChatMsg()}}},[t._v(t._s(t.$t("popoup.text13")))])])])])])],1)},staticRenderFns:[]};var c=a("VU/8")(r,o,!1,function(t){a("hc9V")},"data-v-44618584",null);e.default=c.exports},hc9V:function(t,e){}});